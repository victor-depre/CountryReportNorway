---
title: "Rapport"
author: "Victor"
date: "1/22/2020"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#MAP

##DensityMap

```{r warning=FALSE, include=FALSE}
library(sf)
library(ggplot2)
library(tmap)
library(tmaptools)
library(leaflet)
library(dplyr)

mydata <- readr::read_csv("Density Map/Density per Fylker.csv")

mymap <- st_read("Density Map/NORWAY SHAPE/NOR_adm1.shp", stringsAsFactors = FALSE)

datamap1 <- inner_join(mymap, mydata) 

datamap2 <- ifelse(datamap1$Density >= 0 & datamap1$Density <= 5, "0 to 5", ifelse(datamap1$Density >= 6 & datamap1$Density <= 10, "6 to 10", ifelse(datamap1$Density >= 11 & datamap1$Density <= 20, "11 to 20", ifelse(datamap1$Density >= 21 & datamap1$Density <= 50, "21 to 50", ifelse(datamap1$Density >= 51 & datamap1$Density <= 100, "51 to 100", ifelse(datamap1$Density >= 101 & datamap1$Density <= 200, "101 to 200", ifelse(datamap1$Density >= 201 & datamap1$Density <= 500, "201 to 500", ifelse(datamap1$Density >= 501, "501 or more", NA))))))))

cut(datamap1$Density, breaks=c(0, 5, 10, 20, 50, 100, 200, 500, Inf), labels=c("0 to 5", "6 to 10", "11 to 20", "21 to 50", "51 to 100", "101 to 200","201 to 500", "500 or more"))

mylabels <- c("0 to 5", "6 to 10", "11 to 20", "21 to 50", "51 to 100", "101 to 200", "201 to 500", "500 or more")

```

```{r warning=FALSE, include=FALSE}

datamap1$Density <- base::cut(datamap1$Density,
                        breaks = c(0, 5, 10, 20, 50, 100, 200, 500, 2000), 
                        labels = mylabels, right = F, ordered_result = T)

```

```{r warning=FALSE, include=FALSE}

tm_shape(datamap1) +
  tm_polygons("Density", id = "NAME_1", palette = "Oranges")+ "Density"
  theme_minimal()
  
tmap_mode("view")
DensityMap <- tmap_last()

```

```{r warning=FALSE}

DensityMap

tmap_save(DensityMap, "DensityMap.html")

```

Description

This map highlights the great disparity that exists on the Norwegian territory in terms of Density. Indeed, one notices immediately that the vast majority of the country is very sparsely populated. Most regions have a Density of less than 20 inhabitants per km². By way of comparison, the average Density in France is about 117 inhabitants per km² compared to 13 in Norway. 


##GdpMap

```{r include=FALSE}

library(sf)
library(ggplot2)
library(tmap)
library(tmaptools)
library(leaflet)
library(dplyr)

mydatabis <- readr::read_csv("Gdp Map/GDPperFylker.csv")

mymapbis <- st_read("Gdp Map/NORWAY SHAPE BIS/NOR_adm1.shp", stringsAsFactors = FALSE)

datamap1bis <- inner_join(mymapbis, mydatabis) 


```

```{r warning=FALSE, include=FALSE}

tm_shape(datamap1bis) +
  tm_polygons("GDP, millions of euro", id = "NAME_1", palette = "Greens")+ "GDP"
  theme_minimal()
  
tmap_mode("view")
GdpMap <- tmap_last()

```

```{r warning=FALSE}

GdpMap

tmap_save(GdpMap, "GdpMap.html")

```

##MigrationMap

```{r include=FALSE}

library(sf)
library(ggplot2)
library(tmap)
library(tmaptools)
library(leaflet)
library(dplyr)

mydatabisbis <- readr::read_csv("Migration Map/MigrationRateperFylker.csv")

mymapbisbis <- st_read("Migration Map/NORWAY SHAPE BIS BIS/NOR_adm1.shp", stringsAsFactors = FALSE)

datamap1bisbis <- inner_join(mymapbisbis, mydatabisbis) 


```

```{r warning=FALSE, include=FALSE}

tm_shape(datamap1bisbis) +
  tm_polygons("Net migration rate, %", id = "NAME_1", palette = "Blues")+ "Net migration rate, %"
  theme_minimal()
  
tmap_mode("view")
MigrationMap <- tmap_last()

```

```{r warning=FALSE}

MigrationMap

tmap_save(MigrationMap, "MigrationMap.html")

```


##UNEMPLOYMENTMAP

```{r include=FALSE}

library(sf)
library(ggplot2)
library(tmap)
library(tmaptools)
library(leaflet)
library(dplyr)

mydatabisbisbis <- readr::read_csv("Unemployment Map/Unemployment per Fylker.csv")

mymapbisbisbis <- st_read("Unemployment Map/NORWAY SHAPE BIS BIS BIS/NOR_adm1.shp", stringsAsFactors = FALSE)

datamap1bisbisbis <- inner_join(mymapbisbisbis, mydatabisbisbis) 


```

```{r warning=FALSE, include=FALSE}

tm_shape(datamap1bisbisbis) +
  tm_polygons("Unemployment rate, %", id = "NAME_1", palette = "Purples")+ "Unemployment rate, %"
  theme_minimal()
  
tmap_mode("view")
UnemploymentMap <- tmap_last()

```

```{r warning=FALSE}

UnemploymentMap

tmap_save(UnemploymentMap, "UnemploymentMap.html")

```


#GRAPHS

##Graph1

Air pollution

```{r, include=FALSE}

library(spiR)

EQU <- sqs_spi_data(country = c("AUS", "DNK", "NOR", "NLD", "DEU"), 
                       year = c("2014","2015","2016", "2017", "2018", "2019"), 
                       indicators = "EQU_2")

```

```{r, include=FALSE}

library(ggplot2)
library(plotly)

EQU <- EQU[order(EQU$countryName),]

graph6 <- ggplot(EQU, aes(var_year, value, color = countryName)) +
  geom_point(aes(size = 1, frame = var_year)) +
  scale_x_log10() + theme(plot.subtitle = element_text(vjust = 1), 
    plot.caption = element_text(vjust = 1), 
    axis.text.y = element_text(size = 5)) +
    theme(axis.text.y = element_text(size = 7)) + labs(title = "Air pollution attributable deaths") +labs(x = "Year", y = "Deaths per year") + labs(colour = NULL, size = NULL)

graph7 <- ggplotly(graph6)
graph7

```

```{r}
graph7
```

##GRAPH2

Health and Wellness 

```{r, include=FALSE}

library(spiR)

HWE <- sqs_spi_data(country = c("AUS", "DNK", "NOR", "NLD", "DEU"), 
                       year = c("2014","2015","2016", "2017", "2018", "2019"), 
                       indicators = "HWE")

```

```{r, include=FALSE}
library(ggplot2)
library(plotly)

graph2 <- ggplot(HWE) +
 aes(x = var_year, y = value, colour = countryName, group = countryName) +
 geom_line(size = 1.2) +
 scale_color_hue() + 
 labs(x = "Year", y = "Health & Wellness Indicator", title = "Health & Wellness", color = "Countries") +
 theme_minimal() 

graph2 <- ggplotly(graph2)
graph2

```

```{r}
graph2
```

##GRAPH3

Wellbeing

```{r, include=FALSE}
library(spiR)

FOW <- sqs_spi_data(country = c("AUS", "DNK", "NOR", "NLD", "DEU"), 
                       year = c("2014","2015","2016", "2017", "2018", "2019"), 
                       indicators = "FOW")
```

```{r, include=FALSE}

library(ggplot2)
library(plotly)

graph <- ggplot(FOW) +
 aes(x = var_year, y = value, colour = countryName, group = countryName) +
 geom_line(size = 1.2) +
 scale_color_hue() +
 labs(x = "Year", y = "Wellbeing Indicator", title = "Wellbeing", color = "Countries") +
 theme_minimal() 

graph1 <- ggplotly(graph)
graph1

```

```{r}
graph1
```

##GRAPH4

Electricty Quality 

```{r, include=FALSE}

library(spiR)

SHE_2 <- sqs_spi_data(country = c("AUS", "DNK", "NOR", "NLD", "DEU"), 
                       year = c("2014","2015","2016", "2017", "2018", "2019"), 
                       indicators = "SHE_2")


SHE_2

```

```{r, include=FALSE}
library(ggplot2)
library(plotly)

graph3 <- ggplot(SHE_2) +
 aes(x = var_year, y = value, colour = countryName, group = countryName) +
 geom_line(size = 1.2) +
 scale_color_hue() +
 labs(x = "Year", y = "Electricity Quality Indicator", title = "Electricity Quality", color = "Countries") +
 theme_minimal() 

graph31 <- ggplotly(graph3)
graph31

```

```{r}
graph31
```


##GRAPH5

```{r}
library(spiR)
sqs_spi_indicator()
```



```{r}
library(spiR)

SPI <- sqs_spi_data(country = c("AUS", "DNK", "NOR", "NLD", "DEU"), 
                       year = c("2014","2015","2016", "2017", "2018", "2019"), 
                       indicators = "SPI")

SPI
```











##GRAPH6

```{r include=FALSE}
library(WDI)
Listofindicators <- WDIsearch()
Listofindicators
```


```{r include=FALSE}
library(WDI)
library(ggplot2)
library(plotly)

TB <- WDI(indicator = "NE.RSB.GNFS.CD", country = c("NOR"), start = 1970, end = 2020)
TB

graphTB <- ggplot(TB) +
 aes(x = year, y = NE.RSB.GNFS.CD, fill = country) +
 geom_area(size = 1L) +
 scale_fill_brewer(palette = "PuOr") +
 labs(y = "dollars", title = "Norway's trade balance (in $)") +
 theme_minimal() +
 theme(legend.position = "none")

DynagraphTB <- ggplotly(graphTB)

```

```{r}

DynagraphTB

```














##GRAPH7

```{r include=FALSE}
IndexEcoFree <- data.frame(
  stringsAsFactors = FALSE,
  Category=c("Property Rights", "Judical Effectiveness", "Government Integrity", "Tax Burden", "Government Spending", "Fiscal Health", "Business Freedom", "Labor Freedom", "Monetary Freedom", "Trade Freedom", "Investment Freedom", "Financial Freedom"),
  Score=c(84.3,	82.8,	95.6,	57.7,	25.6,	86.1,	57.4,	86.7,	74.8,	83.8,	75,	60))

IndexEcoFree$Category <- with(IndexEcoFree, reorder(Category, +Score))

IndexEcoFree1 <- ggplot(IndexEcoFree, 
            aes(x = Category, y = Score, color = Score, label = Score)) +
  geom_col(aes(fill = Score)) +
  ggtitle("Index of Economic Freedom, 2019") + 
  xlab("Category") + ylab("Score") + 
  coord_flip() +
  labs(caption = "Source: www.heritage.org") +
  scale_fill_distiller(palette = "Oranges", trans = "reverse") +
  scale_color_distiller(palette = "Oranges", trans = "reverse") +
  theme(legend.position = "none") + 
  theme(panel.background = element_rect(fill = "gray98")) +
  theme(plot.title = element_text(hjust = 0.5))
  
DynagraphEF <- ggplotly(IndexEcoFree1)

```

```{r}

DynagraphEF
  
```



##GRAPH8

```{r include=FALSE}

IndexEcoFreeRanking <- data.frame(
  stringsAsFactors = FALSE,
  Category=c("Singapore", "Hong Kong", "New Zealandy", "Australia", "Switzerland", "Ireland", "United Kingdom", "Denmark", "Canada", "Estonia", "Taiwan", "Georgia", "Iceland", "Netherlands", "Chile", "Lithuania", "United States", "United Arab Emirates", "Luxembourg", "Finland ", "Mauritius", "Sweden", "Czech Republic", "Malaysia", "South Korea", "Israel", "Germany", "Norway", "Austria", "Japan"),
  Score=c(89.4	, 89.1, 84.1, 82.6	, 82.0	, 80.9, 79.3	, 78.3, 78.2, 77.7, 77.1, 77.1, 77.1, 77.0, 76.8, 76.7, 76.6, 76.2	, 75.8, 75.7, 74.9, 74.9, 74.8, 74.7	, 74.0, 74.0, 73.5, 73.4, 73.3, 73.3)) 

IndexEcoFreeRanking$Category <- with(IndexEcoFreeRanking, reorder(Category, +Score))

IndexEcoFreeRanking1 <- ggplot(IndexEcoFreeRanking, 
            aes(x = Category, y = Score, color = Score, label = Score)) +
  geom_col(aes(fill = Score)) +
  ggtitle("Ranking average scores") + 
  xlab("Country") + ylab("Score") + 
  coord_flip() +
  labs(caption = "Source: www.heritage.org") +
  scale_fill_distiller(palette = "Oranges", trans = "reverse") +
  scale_color_distiller(palette = "Oranges", trans = "reverse") +
  theme(legend.position = "none") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text = element_text(size = 7), 
  panel.background = element_rect(fill = "gray98")) +labs(caption = NULL)
  
DynagraphRK <- ggplotly(IndexEcoFreeRanking1)

```

```{r}

DynagraphRK
  
```




















